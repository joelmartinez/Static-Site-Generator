<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title> Running PowerShell from C# in 2025</title>
  <meta name="author" content="Joel Martinez" />
  <meta name="nlweb:ai-access" content="allow" />
  <link rel="icon" type="image/svg+xml" href="/design/images/codecube-logo-web.svg" />
  <link rel="alternate" type="application/rss+xml" title=" Running PowerShell from C# in 2025" href="//codecube.net/feed/" />
  <link rel="nlweb-manifest" href="/nlweb.json" />
	<link rel="stylesheet" type="text/css" href="/design/style2.css" />
      <meta name="title" content=" Running PowerShell from C# in 2025" />
      <meta name="description" content="While checking my analytics recently, I noticed that an old post of mine from 2009 was still getting hits. It was a little helper class I had put together to run PowerShell scripts from a C# app. A..." />
      <link rel="canonical" href="https://codecube.net/2025/7/powershell-from-csharp-updated/" />
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:site" content="@joelmartinez" />
      <meta name="twitter:creator" content="@joelmartinez" />
      <meta name="twitter:title" content=" Running PowerShell from C# in 2025" />
      <meta name="twitter:description" content="While checking my analytics recently, I noticed that an old post of mine from 2009 was still getting hits. It was a little helper class I had put together to run PowerShell scripts from a C# app. A..." />
      <meta property="og:type" content="article" />
      <meta property="og:title" content=" Running PowerShell from C# in 2025" />
      <meta property="og:description" content="While checking my analytics recently, I noticed that an old post of mine from 2009 was still getting hits. It was a little helper class I had put together to run PowerShell scripts from a C# app. A..." />
  
  <script src="/script/tone.js"></script>
  <script src="/script/app.gen.js"></script>
</head>
<body>
  <header>
    <div class="branding">
      <a href="/" style="text-decoration: none; display: flex; align-items: center; gap: 1rem;">
        <img
          src="/design/images/codecube-logo-web.svg"
          alt="CodeCube Ventures logo"
          height="48"
          id="site-logo"
        />
        <div class="site-title">
          <span class="title-main">CODECUBE</span>
          <span class="title-sub">VENTURES</span>
        </div>
      </a>
    </div>
    <nav>
      <ul class="nav-list">
        <li><a href="/resume/">Resume</a></li>
        <li><a href="/about/">About</a></li>
      </ul>
    </nav>
  </header>

  <main>
	  <article class="hentry" itemscope itemtype="https://schema.org/Article">
  <h1 class="entry-title" itemprop="headline"> Running PowerShell from C# in 2025</h1>
  <p id="author">By <a href="http://codecube.net" title="More posts by Joel Martinez" rel="author" itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="name">Joel Martinez</span></a> on <time class="published" itemprop="datePublished" datetime="2025-07-16">07/16/2025</time>
</p>
  
  
  <div class="entry-content" itemprop="articleBody">
    <p>While checking my analytics recently, I noticed that an old post of mine from 2009 was still getting hits. It was a little helper class I had put together to run PowerShell scripts from a C# app. At the time, the approach was to just spin up a powershell.exe process, pass in a script path, and build the parameter list with some string interpolation. It worked well enough for simple automation, and the code was lightweight with no extra dependencies.</p>
<p>What I didn’t do back then was use the actual PowerShell SDK. It existed in some form, but to get access to <code>System.Management.Automation.dll</code>, you had to install the full Windows SDK or dig around in system folders to find it. There was no NuGet package, and it definitely wasn’t something you could just drop into a cross-platform app. Since I didn’t want to add that kind of dependency to the project, I stuck with shelling out to <code>powershell.exe</code>.</p>
<p>Things have changed since then. Today, .NET is fully cross-platform, and PowerShell is too. You can install PowerShell Core on Windows, macOS, and Linux, and you can grab the PowerShell SDK directly from NuGet without needing the Windows SDK at all. More importantly, you can host the PowerShell runtime in-process, which means you can run scripts with typed parameters and capture structured output, without ever building up a shell command by hand.</p>
<p>I figured I’d revisit the topic and show how to do this the right way in 2025.</p>
<p>To try this out, open a terminal and create a new console app. I made a folder called <code>pwsh-runner</code>, ran <code>dotnet new console</code> inside it, and then added the SDK with:</p>
<pre><code class="language-bash">dotnet add package Microsoft.PowerShell.SDK
</code></pre>
<p>That’s it for setup.</p>
<p>Next, I dropped a small PowerShell script in the project directory. It’s just a simple file called example.ps1 with the following contents:</p>
<pre><code class="language-pwsh">param(
  [string]$name,
  [int]$count
)

&quot;Hello, $name! You’ve run this $count times.&quot;
</code></pre>
<p>Back in the C# app, I replaced the contents of <code>Program.cs</code> with this:</p>
<pre><code class="language-csharp">using System.Management.Automation;

var scriptPath = Path.Combine(Directory.GetCurrentDirectory(), &quot;example.ps1&quot;);

using var ps = PowerShell.Create();
ps.AddCommand(scriptPath);
ps.AddParameter(&quot;name&quot;, &quot;Joel&quot;);
ps.AddParameter(&quot;count&quot;, 3);

var results = ps.Invoke();

foreach (var result in results)
{
    Console.WriteLine(result);
}
</code></pre>
<p>When I ran <code>dotnet run</code>, it printed:</p>
<pre><code>Hello, Joel! You’ve run this 3 times.
</code></pre>
<p>No shell commands, no string interpolation, no fuss. Just calling into the PowerShell runtime from C# and getting clean output back. And this works the same way on Windows, macOS, or Linux, as long as PowerShell Core is installed on the system.</p>
<p>There are still valid reasons to run PowerShell via an external process in some scenarios, especially if you need process isolation or are doing impersonation. But for most automation and tooling use cases, hosting PowerShell directly like this is easier and much safer. You don’t have to worry about escaping quotes, validating user input against injection attacks, or dealing with platform-specific quirks in how the shell parses arguments.</p>
<p>It’s always interesting to look back at old solutions that got the job done but came with caveats that were just normal at the time. The tooling has come a long way, and if you’re still relying on the old <code>Process.Start</code> approach, it might be time to give this a fresh look.</p>

  </div>
</article>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": " Running PowerShell from C# in 2025",
  "description": "While checking my analytics recently, I noticed that an old post of mine from 2009 was still getting hits. It was a little helper class I had put together to run PowerShell scripts from a C# app. A...",
  "author": {
    "@type": "Person",
    "name": "Joel Martinez",
    "url": "https://codecube.net/about/"
  },
  "publisher": {
    "@type": "Person",
    "name": "Joel Martinez",
    "url": "https://codecube.net"
  },
  "datePublished": "2025-07-16",
  "dateModified": "2025-07-16",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://codecube.net/2025/7/powershell-from-csharp-updated/"
  }
}
</script>

<p><strong>Latest post:</strong> <a href="/2025/7/team-series-death-by-status/"> Death By Status</a></p>

<nav class="post-navigation">
    <div class="nav-previous">
        <p><strong>Previous:</strong> <a href="/2009/11/executing-powershell-scripts-via-c/">Executing PowerShell Scripts via C#</a></p>
        <p>When Dave asked me for some help with a little side project of his that he was researching, I jumped at the chance.&#xA0; The requirement was to execute a powershell script programmatically and pass in ...</p>
    </div>
    
</nav>

<p>See more in the <a href="/#archives">archives</a>
</p>

  </main>

  <footer>
    copyright 2013 - 2025 - <a rel="me" href="https://mastodon.social/@joelmartinez">me @ Mastodon</a> and <a rel="me" href="https://www.threads.net/@joeldm1971">Threads</a>
  </footer>

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WV9DDDSFMW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WV9DDDSFMW');
</script>
</body>
</html>
