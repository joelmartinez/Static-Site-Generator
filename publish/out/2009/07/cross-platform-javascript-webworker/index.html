<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Cross-Platform Javascript WebWorker</title>
  <meta name="author" content="Joel Martinez" />
  <meta name="nlweb:ai-access" content="allow" />
  <link rel="icon" type="image/svg+xml" href="/design/images/codecube-logo-web.svg" />
  <link rel="alternate" type="application/rss+xml" title="Cross-Platform Javascript WebWorker" href="//codecube.net/feed/" />
  <link rel="nlweb-manifest" href="/nlweb.json" />
	<link rel="stylesheet" type="text/css" href="/design/style2.css" />
      <meta name="title" content="Cross-Platform Javascript WebWorker" />
      <meta name="description" content="If you&#x2019;ve been keeping up with the new developments in the web world, no doubt you&#x2019;ve heard about Web Workers.&#xA0; A new technology for browsers that will let you take advantage of the client&#x2019;s true m..." />
      <link rel="canonical" href="http://codecube.net/2009/07/cross-platform-javascript-webworker/" />
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:site" content="@joelmartinez" />
      <meta name="twitter:creator" content="@joelmartinez" />
      <meta name="twitter:title" content="Cross-Platform Javascript WebWorker" />
      <meta name="twitter:description" content="If you&#x2019;ve been keeping up with the new developments in the web world, no doubt you&#x2019;ve heard about Web Workers.&#xA0; A new technology for browsers that will let you take advantage of the client&#x2019;s true m..." />
      <meta property="og:type" content="article" />
      <meta property="og:title" content="Cross-Platform Javascript WebWorker" />
      <meta property="og:description" content="If you&#x2019;ve been keeping up with the new developments in the web world, no doubt you&#x2019;ve heard about Web Workers.&#xA0; A new technology for browsers that will let you take advantage of the client&#x2019;s true m..." />
  
  <script src="/script/tone.js"></script>
  <script src="/script/app.gen.js"></script>
</head>
<body>
  <header>
    <div class="branding">
      <a href="/" style="text-decoration: none; display: flex; align-items: center; gap: 1rem;">
        <img
          src="/design/images/codecube-logo-web.svg"
          alt="CodeCube Ventures logo"
          height="48"
          id="site-logo"
        />
        <div class="site-title">
          <span class="title-main">CODECUBE</span>
          <span class="title-sub">VENTURES</span>
        </div>
      </a>
    </div>
    <nav>
      <ul class="nav-list">
        <li><a href="/resume/">Resume</a></li>
        <li><a href="/about/">About</a></li>
      </ul>
    </nav>
  </header>

  <main>
	  <article class="hentry" itemscope itemtype="https://schema.org/Article">
  <h1 class="entry-title" itemprop="headline">Cross-Platform Javascript WebWorker</h1>
  <p id="author">By <a href="http://codecube.net" title="More posts by Joel Martinez" rel="author" itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="name">Joel Martinez</span></a> on <time class="published" itemprop="datePublished" datetime="2009-07-24">07/24/2009</time>
</p>
  
  
  <div class="entry-content" itemprop="articleBody">
    If you’ve been keeping up with the new developments in the web world, no doubt you’ve heard about Web Workers.  A new technology for browsers that will let you take advantage of the client’s true multi-threading capabilities.  Currently, it’s only supported in Firefox 3.5, Safari 4, and some of the latest nightly Chrome builds.<br /><br />I of course am very excited that the platform is moving ahead.  However, I am disheartened by the fact that it will take *ages* for the majority of the population to move to a browser that supports this feature.  So naturally started thinking about how I might be able to take advantage of this new feature, while still supporting older browsers.<br /><br />Below you will find a relatively small script that will conditionally declare the Worker class if it’s not currently declared.  I tested it and it worked in IE8 in addition to Chrome (not the nightly with worker support), and of course FireFox 3.5, where it executes using the new feature rather than the wrapper.<br /><br /><em>please note: This code has a small dependency on <a href="http://jquery.com/">jQuery</a> to do the ajax call.  It should be pretty easy to substitute that with another framework's analogous feature if you so prefer.</em>
<h3>The Worker Class</h3>
<blockquote>if (!Worker) {
function Worker(path) {
function InternalWorker(p) {
this.onmessage = function(m) {
if (trace)
trace('received ' + m);
};<br /><br />$.get(p, function(data) {
setTimeout(function() {
eval(data);
}, 1);
});
}<br /><br />var iworker = new InternalWorker(path);<br /><br />function postMessage(m) {
setTimeout(function() { iworker.onmessage({ data: m }) }, 1);
}<br /><br />return iworker;
}
}</blockquote>
<h3>The Usage</h3>
Once you’ve included the above script, you can use it as such:
<blockquote>&lt;script&gt;
var worker = new Worker('Scripts/worker.js');
worker.onmessage = function(event) {
$("#result").text(event.data);
};
&lt;/script&gt;<br /><br />&lt;div id="result"&gt;&lt;/div&gt;</blockquote>
<h3>The Worker Script</h3>
The file mentioned above (Scripts/worker.js) is defined in my sample as follows:
<blockquote>postMessage("this is from the web worker");</blockquote>
I know, simple … all it does is post a message back to the main gui thread.
<h3>How it Works</h3>
The premise is very simple. If we need to fall back to manually supporting the feature on a downlevel browser, then we take the path to the script file which is passed into the constructor and download the contents of it using the $.get method.  We take that and use the setTimeout method to execute said script using the eval method.<br /><br />This is of course not production-ready code. More of a proof of concept as I’ve only implemented the basic execution of the remote script, and passing messages back to the client.  If you actually try to do some heavy computation, the main thread will obviously get bogged down.  This will of course prompt IE to ask the user if they want to cancel the script.<br /><br />However, I still see some value in being able to code using this API on all browsers.  The concept of message passing forces you to have clearly defined boundaries between functionality.  If your DOM modifying code can only talk to the validation functionality using messages, there’s a much higher chance that your code will be easy to maintain.<br /><br />Please let me know if anyone is interested in further development of this little wrapper.  I’d like to collaborate on it and perhaps release a more fully featured and minified version on codeplex.<br /><br />Thanks!
  </div>
</article>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "Cross-Platform Javascript WebWorker",
  "description": "If you\u2019ve been keeping up with the new developments in the web world, no doubt you\u2019ve heard about Web Workers.\u00A0 A new technology for browsers that will let you take advantage of the client\u2019s true m...",
  "author": {
    "@type": "Person",
    "name": "Joel Martinez",
    "url": "https://codecube.net/about/"
  },
  "publisher": {
    "@type": "Person",
    "name": "Joel Martinez",
    "url": "https://codecube.net"
  },
  "datePublished": "2009-07-24",
  "dateModified": "2009-07-24",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://codecube.net/2009/07/cross-platform-javascript-webworker/"
  }
}
</script>

<p><strong>Latest post:</strong> <a href="/2025/7/team-series-death-by-status/"> Death By Status</a></p>


<p>See more in the <a href="/#archives">archives</a>
</p>

  </main>

  <footer>
    copyright 2013 - 2025 - <a rel="me" href="https://mastodon.social/@joelmartinez">me @ Mastodon</a> and <a rel="me" href="https://www.threads.net/@joeldm1971">Threads</a>
  </footer>

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WV9DDDSFMW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WV9DDDSFMW');
</script>
</body>
</html>
