<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>XNA Resource Pool</title>
  <meta name="author" content="Joel Martinez" />
  <meta name="nlweb:ai-access" content="allow" />
  <link rel="icon" type="image/svg+xml" href="/design/images/codecube-logo-web.svg" />
  <link rel="alternate" type="application/rss+xml" title="XNA Resource Pool" href="//codecube.net/feed/" />
  <link rel="nlweb-manifest" href="/nlweb.json" />
	<link rel="stylesheet" type="text/css" href="/design/style2.css" />
      <meta name="title" content="XNA Resource Pool" />
      <meta name="description" content="This is likely an old topic at this point, considering the XNA framework has been out for several years. However, I meant to follow up on the topic of Resource Pooling after I posted the ..." />
      <link rel="canonical" href="http://codecube.net/2010/01/xna-resource-pool/" />
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:site" content="@joelmartinez" />
      <meta name="twitter:creator" content="@joelmartinez" />
      <meta name="twitter:title" content="XNA Resource Pool" />
      <meta name="twitter:description" content="This is likely an old topic at this point, considering the XNA framework has been out for several years. However, I meant to follow up on the topic of Resource Pooling after I posted the ..." />
      <meta property="og:type" content="article" />
      <meta property="og:title" content="XNA Resource Pool" />
      <meta property="og:description" content="This is likely an old topic at this point, considering the XNA framework has been out for several years. However, I meant to follow up on the topic of Resource Pooling after I posted the ..." />
  
  <script src="/script/tone.js"></script>
  <script src="/script/app.gen.js"></script>
</head>
<body>
  <header>
    <div class="branding">
      <a href="/" style="text-decoration: none; display: flex; align-items: center; gap: 1rem;">
        <img
          src="/design/images/codecube-logo-web.svg"
          alt="CodeCube Ventures logo"
          height="48"
          id="site-logo"
        />
        <div class="site-title">
          <span class="title-main">CODECUBE</span>
          <span class="title-sub">VENTURES</span>
        </div>
      </a>
    </div>
    <nav>
      <ul class="nav-list">
        <li><a href="/resume/">Resume</a></li>
        <li><a href="/about/">About</a></li>
      </ul>
    </nav>
  </header>

  <main>
	  <article class="hentry" itemscope itemtype="https://schema.org/Article">
  <h1 class="entry-title" itemprop="headline">XNA Resource Pool</h1>
  <p id="author">By <a href="http://codecube.net" title="More posts by Joel Martinez" rel="author" itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="name">Joel Martinez</span></a> on <time class="published" itemprop="datePublished" datetime="2010-01-05">01/05/2010</time>
</p>
  
  
  <div class="entry-content" itemprop="articleBody">
    This is likely an old topic at this point, considering the XNA framework has been out for several years. However, I meant to follow up on the topic of Resource Pooling after I posted the <a href="http://codecube.net/2009/02/onetug-xna-presentation-files/">presentation materials</a> from my <a href="http://onetug.org">ONETUG</a> presentation on XNA last February. This is a simple resource pool that you can use to mitigate memory allocation issues in the XNA framework.<br /><br />The canonical example of where a pool is useful, is a game entity firing bullets.  If you simply create a new instance of a bullet each time you fire, you will soon run out of memory.  To avoid allocating new memory each time, you can reuse bullets that have moved off-screen or have collided with something.  There are several implementations that have been posted online such as:
<ul>
	<li><a href="http://www.xnawiki.com/index.php?title=Generic_Resource_Pool">http://www.xnawiki.com/index.php?title=Generic_Resource_Pool</a></li>
	<li><a href="http://swampthingtom.blogspot.com/2007/06/generic-pool-collection-class.html">http://swampthingtom.blogspot.com/2007/06/generic-pool-collection-class.html</a></li>
</ul>
These are great, they definitely do the job.  However, they have a common issue in that they want to take on too much responsibility. In both cases, the resource pool acts as an array to hold all known instances in addition to being concerned with object construction logic.<br /><br />I wanted a simple resource pool which provided the functionality of providing a "new" instance of an object when I needed one. So I created my own; The basic design is that there are only two methods: "New", and "Return".  The new method returns a new instance that is ready to use, while the return method adds a previously obtained object back into the pool.
<blockquote>
<pre>using System;
using System.Collections.Generic;<br /><br />namespace Scurvy
{
    public class Pool&lt;T&gt; where T : class, new()
    {
        private Queue&lt;T&gt; queue;
        private Action&lt;T&gt; newRoutine;<br /><br />        public Pool(int capacity)
        {
            this.queue = new Queue&lt;T&gt;(capacity);
        }<br /><br />        public Pool()
        {
            this.queue = new Queue&lt;T&gt;();
        }<br /><br />        public Pool(Action&lt;T&gt; newRoutine)
            : this()
        {
            this.newRoutine = newRoutine;
        }<br /><br />        public int Count { get { return this.queue.Count; } }<br /><br />        public T New()
        {
            T item;<br /><br />            item = queue.Count &gt; 0 ? queue.Dequeue() : new T();
            if (this.newRoutine != null) this.newRoutine(item);<br /><br />            return item;
        }<br /><br />        public void Return(T item)
        {
            queue.Enqueue(item);
        }
    }
}
</pre>
</blockquote>
An interesting feature of this pool is that you can control the object initialization logic by providing a simple lambda to the constructor.  Any initialization logic (such as resetting "isdead" fields, or resetting positions) can be done there and it will be executed for each new instance.<br /><br />I'd love to get feedback on this class if you end up using it in a project.  Thanks!
  </div>
</article>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "XNA Resource Pool",
  "description": "This is likely an old topic at this point, considering the XNA framework has been out for several years. However, I meant to follow up on the topic of Resource Pooling after I posted the ...",
  "author": {
    "@type": "Person",
    "name": "Joel Martinez",
    "url": "https://codecube.net/about/"
  },
  "publisher": {
    "@type": "Person",
    "name": "Joel Martinez",
    "url": "https://codecube.net"
  },
  "datePublished": "2010-01-05",
  "dateModified": "2010-01-05",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://codecube.net/2010/01/xna-resource-pool/"
  }
}
</script>

<p><strong>Latest post:</strong> <a href="/2025/7/team-series-death-by-status/"> Death By Status</a></p>


<p>See more in the <a href="/#archives">archives</a>
</p>

  </main>

  <footer>
    copyright 2013 - 2025 - <a rel="me" href="https://mastodon.social/@joelmartinez">me @ Mastodon</a> and <a rel="me" href="https://www.threads.net/@joeldm1971">Threads</a>
  </footer>

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WV9DDDSFMW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WV9DDDSFMW');
</script>
</body>
</html>
