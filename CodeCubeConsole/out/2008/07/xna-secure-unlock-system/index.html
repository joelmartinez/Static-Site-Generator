<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf8" />
	<title>XNA Secure Unlock System</title>
  <meta name="author" content="Joel Martinez" />
  <meta name="nlweb:ai-access" content="allow" />
  <link rel="alternate" type="application/rss+xml" title="XNA Secure Unlock System" href="//codecube.net/feed/" />
  <link rel="nlweb-manifest" href="/nlweb.json" />
	<link rel="stylesheet" type="text/css" href="/design/style.css?v=2" />
      <meta name="title" content="XNA Secure Unlock System" />
      <meta name="description" content="A recent forum thread unearthed a great idea by Jon Watte&#xA;To generate revenue, you could have an unlock mechanism, where someone pays you money and gets an unlock code. ..." />
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:site" content="@joelmartinez" />
      <meta name="twitter:creator" content="@joelmartinez" />
      <meta name="twitter:title" content="XNA Secure Unlock System" />
      <meta name="twitter:description" content="A recent forum thread unearthed a great idea by Jon Watte&#xA;To generate revenue, you could have an unlock mechanism, where someone pays you money and gets an unlock code. ..." />
      <meta property="og:type" content="article" />
      <meta property="og:title" content="XNA Secure Unlock System" />
      <meta property="og:description" content="A recent forum thread unearthed a great idea by Jon Watte&#xA;To generate revenue, you could have an unlock mechanism, where someone pays you money and gets an unlock code. ..." />
      <meta name="twitter:image" content="http://codecube.net/bloguploads/XNASecureUnlockSystem_9E7C/unlock_server_gui_thumb.png" />
      <meta property="og:image" content="http://codecube.net/bloguploads/XNASecureUnlockSystem_9E7C/unlock_server_gui_thumb.png" />
      <meta name="image" content="http://codecube.net/bloguploads/XNASecureUnlockSystem_9E7C/unlock_server_gui_thumb.png" />
  
  <script src="/script/tone.js"></script>
</head>
<body>
  <div id="header">
    <div>
	  <a href="/" rel="home"><img height="50" width="50" src="//www.gravatar.com/avatar/a61a4be80ce39683142620a76299820b.png" title="ItsAMeee" /></a>
      <a href="/about/" rel="author">Joel Martinez</a>
      <a href="/resume/">Resume</a>

      <img id="flair" src="/design/images/flair.png" />
    </div>
  </div>

  <div id="contentwrapper">
	  <div id="content">
		<article class="hentry" itemscope itemtype="https://schema.org/Article">
  <h1 class="entry-title" itemprop="headline">XNA Secure Unlock System</h1>
  <p id="author">By <a href="http://codecube.net" title="More posts by Joel Martinez" rel="author" itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="name">Joel Martinez</span></a> on <time class="published" itemprop="datePublished" datetime="2008-07-07">07/07/2008</time>
</p>
  <div class="entry-content" itemprop="articleBody">
    A recent <a href="http://forums.xna.com/forums/p/12983/71313.aspx">forum thread</a> unearthed a great idea by Jon Watte
<blockquote>To generate revenue, you could have an unlock mechanism, where someone pays you money and gets an unlock code. <strong>The unlock code would be some hash of their gamer tag and a key</strong>, and the game would know whether it's right or not. Because it's a hash, you can't use the same unlock code for two different gamer tags. Just beware that if you're not selling anything tangible, you should budget 10-20% of your revenue to credit card charge-backs and fraud.</blockquote>
I got curious on what it would take for such a solution to be implemented.  The first thing that occurred to me is that there would be two components to this feature.  One would be the in-game unlock mechanism, while the other is the external component that would more-than-likely be implemented as a website.<br /><br /><p class="securedownload">Sample Code:
<a title="http://codecube.net/bloguploads/UnlockCodes.zip" href="http://codecube.net/bloguploads/UnlockCodes.zip">http://codecube.net/bloguploads/UnlockCodes.zip</a></p><br /><br /><h3>In-Game Implementation</h3>
You might initially think that the in-game implementation would be rather simple through the use of the .NET framework's powerful cryptography namespace.  But alas, if you plan on targeting the XBox 360 or Zune platforms, you will quickly find yourself disappointed.  That namespace is not available on the Compact Framework.<br /><br />Thankfully, the compact framework has been around longer than XNA ... and so others have had the need, and subsequently implemented the solution for this problem:
<a title="http://www.flowgroup.fr/en/kb/technical/md5.aspx" href="http://www.flowgroup.fr/en/kb/technical/md5.aspx">http://www.flowgroup.fr/en/kb/technical/md5.aspx</a><br /><br />From the fine folks at FlowGroup:
<blockquote>The cryptography classes are not available on the Compact Framework 1.0, so we ported the "MD5 Message-Digest Algorithm" from RSA Data Security, Inc. in C#.</blockquote>
With the ability to generate hashes on the compact framework, we can then focus on how we can implement our secure unlock mechanism.  Using three values:
<ul>
	<li><strong>Developer Secret</strong>: this is a string that is known only to the developer.</li>
	<li><strong>User Secret</strong>: this is something known only to the user.</li>
	<li><strong>GamerTag</strong>: The user's gamertag.  He must be logged in with this gamertag in order to use the code.</li>
</ul>
This technique is so simple you'll kick yourself for not having thought of it.  Taking the three values, simply concatenate them, and then compute the hash using the resulting string.  This provides a very secure way of providing personalized unlock codes.<br /><br />Even if there were users that wanted to subvert your mechanism and share codes, it would not work.  Let's say a user with a GamerTag of <em>SxyLvr</em> decides he wants to post his unlock code to the world.  No one else would be able to use it because they would have to be signed in with <em>SxyLvr</em> in order for it to work.<br /><br />Users will similarly be unable to create codes on their own because they are unlikely to know the developer secret.  That is something that will be known only on the server, and in your game code.  Of course, if you are distributing a windows game, then it can easily be decompiled ... but on windows you are free to use more <a href="http://www.asp.net/Learn/data-access/tutorial-73-cs.aspx">traditional data security techniques</a>; and of course on the xbox (via community games), the user is unable to get access to your binaries<br /><br />With this in place, we are able to create a simple class that has the following interface:<br /><br /><p class="securecode">public class UnlockCodeProvider
{
    public UnlockCodeProvider(string developerSecret, string gamerTag);  
    
    public string ComputeCode(string userSecret);</p>
    public bool Validate(string userSecret, string codeToValidate);
}<br /><br />I won't go into the implementation as you can just download the sample code.  But this very simple class can be instantiated by supplying the developer secret, and the gamertag that we are working with.  The two methods allow you to compute a code using the supplied user secret (ComputeCode), while the other one allows you to validate that a code the user supplied is valid (Validate).<br /><br />This class, and a dreadfully simple "game" shell can be found in the sample download at the top of this post.  This sample shows how to ask the user to log in, get his gamertag; then ask him for the user secret and code he received from the server. <br /><br />Once the user supplies this information, the game will validate the code against a locally computed hash.
<h3>Server Implementation</h3>
The server-side in this equation gives you many many options to choose from.  As mentioned before, this will more than likely be a web application that the developer controls.  The purpose of these unlock codes can be many; for example the developer could charge money for certain cards in a collectible card game.  Or the most active contributors in the developer's favorite community can be given codes as a reward.<br /><br />Whatever the reasoning, the server can be used to generate unlock codes that can subsequently be used in-game to unlock whatever.
<h4>ASP.NET</h4>
I chose ASP.NET for several reasons ... I write C# code all day, and thus I am proficient in it.  This also allows me to re-use the exact same <em>UnlockCodeProvider</em> API that the in-game implementation uses. <br /><br />I threw together a painfully simple ASP.NET GUI that uses simple web forms (postbacks, et al)<br /><br /><a href="http://codecube.net/bloguploads/XNASecureUnlockSystem_9E7C/unlock_server_gui.png"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" src="http://codecube.net/bloguploads/XNASecureUnlockSystem_9E7C/unlock_server_gui_thumb.png" border="0" alt="unlock_server_gui" width="244" height="107" /></a><br /><br />As with the in-game code, this can be found in the sample code found at the top of this article.
<h4>PHP</h4>
I wanted to write a reference implementation in PHP to illustrate the fact that the server-side implementation isn't limited to requiring ASP.NET.  You can use any technology that you are familiar with and/or already have infrastructure for.  PHP seems to be a common choice because hosting is so cheap these days.<br /><br />Unfortunately, due to time constraints, this feature got cut ... so I'll leave it as a user exercise.  I assume though that anyone that's even modestly familiar with PHP can whip this up in about 30 seconds using the hash function :-)<br /><br /><a title="http://us.php.net/manual/en/function.hash.php" href="http://us.php.net/manual/en/function.hash.php">http://us.php.net/manual/en/function.hash.php</a>
<h3>Legality?</h3>
Of course, there are certain interpretations of the EULA that suggest this may not be a legal move for XBox games (ie. to sell unlock codes).  According to the ZMan:
<blockquote>I had the same idea but then I wondered how Microsoft would feel not getting a share of the millions I would be sure to make... Shame the EULA Forbids it right now ...<br /><br />b. Programs developed for the Xbox 360 Platform
i. Personal Use.  Use of any programs developed for the Xbox platform using the software is restricted to your personal, non-commercial use. </blockquote>
That doesn't mean the idea is dead in the water.  You could always give unlock codes in return for email addresses (that you could then use to notify of your next game).  Or you could give them away for registering on your community site ... or really, anything. <br /><br />The world doesn't <strong>have</strong> to revolve around commercial aims just because Adam Smith says so :-)
  </div>
</article>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "XNA Secure Unlock System",
  "description": "A recent forum thread unearthed a great idea by Jon Watte To generate revenue, you could have an unlock mechanism, where someone pays you money and gets an unlock code. ...",
  "author": {
    "@type": "Person",
    "name": "Joel Martinez",
    "url": "https://codecube.net/about/"
  },
  "publisher": {
    "@type": "Person",
    "name": "Joel Martinez",
    "url": "https://codecube.net"
  },
  "datePublished": "2008-07-07",
  "dateModified": "2008-07-07",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://codecube.net/2008/07/xna-secure-unlock-system/"
  }
}
</script>
<p>See more in the <a href="/#archives">archives</a>
</p>

	  </div>
  </div>

  <div id="footer">
    copyright 2013 - 2025 - <a rel="me" href="https://mastodon.social/@joelmartinez">me @ Mastodon</a> and <a rel="me" href="https://www.threads.net/@joeldm1971">Threads</a>
  </div>

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WV9DDDSFMW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WV9DDDSFMW');
</script>
</body>
</html>
