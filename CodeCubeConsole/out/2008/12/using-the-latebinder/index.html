<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Using the LateBinder</title>
  <meta name="author" content="Joel Martinez" />
  <meta name="nlweb:ai-access" content="allow" />
  <link rel="icon" type="image/svg+xml" href="/design/images/codecube-logo-web.svg" />
  <link rel="alternate" type="application/rss+xml" title="Using the LateBinder" href="//codecube.net/feed/" />
  <link rel="nlweb-manifest" href="/nlweb.json" />
	<link rel="stylesheet" type="text/css" href="/design/style2.css" />
      <meta name="title" content="Using the LateBinder" />
      <meta name="description" content="Heh, I seemed to have not realized that I didn&#x27;t include any usage information on the LateBinder in the last post.&amp;nbsp; So here is the how and why you&#x27;d want to use this class. Say you have a need..." />
      <link rel="canonical" href="http://codecube.net/2008/12/using-the-latebinder/" />
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:site" content="@joelmartinez" />
      <meta name="twitter:creator" content="@joelmartinez" />
      <meta name="twitter:title" content="Using the LateBinder" />
      <meta name="twitter:description" content="Heh, I seemed to have not realized that I didn&#x27;t include any usage information on the LateBinder in the last post.&amp;nbsp; So here is the how and why you&#x27;d want to use this class. Say you have a need..." />
      <meta property="og:type" content="article" />
      <meta property="og:title" content="Using the LateBinder" />
      <meta property="og:description" content="Heh, I seemed to have not realized that I didn&#x27;t include any usage information on the LateBinder in the last post.&amp;nbsp; So here is the how and why you&#x27;d want to use this class. Say you have a need..." />
  
  <script src="/script/tone.js"></script>
</head>
<body>
  <header>
    <div class="branding">
      <a href="/" style="text-decoration: none; display: flex; align-items: center; gap: 1rem;">
        <img
          src="/design/images/codecube-logo-web.svg"
          alt="CodeCube Ventures logo"
          height="48"
          id="site-logo"
        />
        <div class="site-title">
          <span class="title-main">CODECUBE</span>
          <span class="title-sub">VENTURES</span>
        </div>
      </a>
    </div>
    <nav>
      <ul class="nav-list">
        <li><a href="/resume/">Resume</a></li>
        <li><a href="/about/">About</a></li>
      </ul>
    </nav>
  </header>

  <main>
	  <article class="hentry" itemscope itemtype="https://schema.org/Article">
  <h1 class="entry-title" itemprop="headline">Using the LateBinder</h1>
  <p id="author">By <a href="http://codecube.net" title="More posts by Joel Martinez" rel="author" itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="name">Joel Martinez</span></a> on <time class="published" itemprop="datePublished" datetime="2008-12-11">12/11/2008</time>
</p>
  <div class="entry-content" itemprop="articleBody">
    <p>Heh, I seemed to have not realized that I didn't include any usage information on the <a href="http://codecube.net/?p=89">LateBinder</a> in the last post.&nbsp; So here is the how and why you'd want to use this class.</p> <p>Say you have a need to dynamically get or set the property of some class using the string name of the property.&nbsp; Normally, the answer would be to use reflection, get the PropertyInfo, extract the MethodInfo of the getter or setter, and then invoke that method using the reflection API.&nbsp; Hardly very usable ... and if you're not careful, you will end up paying the reflection cost everytime because you have to keep looking up the PropertyInfo and all that.</p> <p>Enter the LateBinder&lt;T&gt; ... using this class, you can do:</p> <blockquote> <p>MyClass mcInstance = new MyClass();</p> <p>LateBinder&lt;MyClass&gt; binder = LateBinder&lt;MyClass&gt;.Instance;<br>binder[mcInstance, "Name"] = "my name";<br>string name = (string)binder[mcInstance, "Name"];</p></blockquote> <p>The late binder (on windows) uses the System.Reflection.Emit API to generate a <a href="http://msdn.microsoft.com/en-us/library/system.reflection.emit.dynamicmethod.aspx">DynamicMethod</a>, which is much faster to call than the reflection invoke because it's pre-compiled using custom built IL instructions.&nbsp; It also caches them in the late binder instance so that it only has to be compiled once ... and furthermore, if you use the singleton .Instance method, you only have to do the compilation once per application run since it keeps the data around in a static variable.</p> <p>Beneath the hood, the original version of the late binder was using <a href="http://www.codeproject.com/useritems/Dynamic_Code_Generation.asp">this class</a>.&nbsp; But I had to change the design of the class to support the cross platform aspect of it and to add in the static support.&nbsp; It was pretty fun, I ended up using reflector to decompile some sample code I wrote in a console app so I could see what IL instructions I had to use to get/set the statics ... so with this version of LateBinder, it supports getting and setting both properties and fields ... regardless of whether they are instance or static fields/properties.</p> <p>Now, on XBox and Zune, the story changes a bit because System.Reflection.Emit does not exist.&nbsp; So, in this new version I posted, it falls back to simply using reflection.&nbsp; However, it does keep the propertyinfo in that static cache, so at least you won't have to pay the penalty of looking for it every time.</p> <p>So to get back to the original question on usage (ie. when/why would I want to use it) ... it probably wouldn't be a good idea to use this in a tight loop in runtime code.&nbsp; However, for certain tools and custom serialization code ... it could certainly be very useful.&nbsp; For example, you can relatively easily write code using this that will transfer property values from one class to another ... assuming the property names are the same.&nbsp; The list goes on and on as to how this is useful.</p>
  </div>
</article>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "Using the LateBinder",
  "description": "Heh, I seemed to have not realized that I didn&#x27;t include any usage information on the LateBinder in the last post.&amp;nbsp; So here is the how and why you&#x27;d want to use this class. Say you have a need...",
  "author": {
    "@type": "Person",
    "name": "Joel Martinez",
    "url": "https://codecube.net/about/"
  },
  "publisher": {
    "@type": "Person",
    "name": "Joel Martinez",
    "url": "https://codecube.net"
  },
  "datePublished": "2008-12-11",
  "dateModified": "2008-12-11",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://codecube.net/2008/12/using-the-latebinder/"
  }
}
</script>

<p><strong>Latest post:</strong> <a href="/2025/7/team-series-size/"> When Your Team Gets Bigger - How Teams Grow</a></p>

<p>See more in the <a href="/#archives">archives</a>
</p>

  </main>

  <footer>
    copyright 2013 - 2025 - <a rel="me" href="https://mastodon.social/@joelmartinez">me @ Mastodon</a> and <a rel="me" href="https://www.threads.net/@joeldm1971">Threads</a>
  </footer>

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WV9DDDSFMW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WV9DDDSFMW');
</script>
</body>
</html>
